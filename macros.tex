\usetikzlibrary{decorations.pathreplacing,arrows}

\numberwithin{equation}{chapter}
\declaretheoremstyle[bodyfont=\it,qed=\qedsymbol]{noproofstyle} 

\declaretheorem[numberlike=equation]{axiom}

\declaretheorem[numberlike=equation]{observation}
\declaretheorem[numberlike=equation,style=noproofstyle,name=Observation]{observationwp}
\declaretheorem[name=Observation,numbered=no]{observation*}

\declaretheorem[numberlike=equation]{fact}
\declaretheorem[numberlike=equation]{subclaim}
\declaretheorem[numberlike=equation]{problem}

\declaretheorem[numberlike=equation]{theorem}
\declaretheorem[numberlike=equation,style=noproofstyle,name=Theorem]{theoremwp}
\declaretheorem[name=Theorem,numbered=no]{theorem*}

\declaretheorem[numberlike=equation]{lemma}
\declaretheorem[name=Lemma,numbered=no]{lemma*}
\declaretheorem[numberlike=equation,style=noproofstyle,name=Lemma]{lemmawp}

\declaretheorem[numberlike=equation]{corollary}
\declaretheorem[name=Corollary,numbered=no]{corollary*}
\declaretheorem[numberlike=equation,style=noproofstyle,name=Corollary]{corollarywp}

\declaretheorem[numberlike=equation]{proposition}
\declaretheorem[name=Proposition,numbered=no]{proposition*}
\declaretheorem[numberlike=equation,style=noproofstyle,name=Proposition]{propositionwp}

\declaretheorem[numberlike=equation]{claim}
\declaretheorem[name=Claim,numbered=no]{claim*}
\declaretheorem[numberlike=equation,style=noproofstyle,name=Claim]{claimwp}

\declaretheorem[numberlike=equation]{conjecture}
\declaretheorem[name=Conjecture,numbered=no]{conjecture*}

\declaretheorem[numberlike=equation]{question}
\declaretheorem[name=Question,numbered=no]{question*}
\declaretheoremstyle[
    headfont=\bfseries, 
    notebraces={[}{]},
    bodyfont=\normalfont\itshape,
    headpunct={},
%    postheadspace=\newline,
%    postheadhook={\textcolor{red}{\rule[.6ex]{\linewidth}{0.4pt}}\\},
    spacebelow=\parsep,
    spaceabove=\parsep,
    mdframed={
        backgroundcolor=white, 
            linecolor=black!80, 
            innertopmargin=6pt,
            roundcorner=5pt, 
            innerbottommargin=6pt, 
            skipabove=\parsep, 
            skipbelow=\parsep } 
]{exercisestyle}

\declaretheoremstyle[
    headfont=\bfseries, 
    notebraces={[}{]},
    bodyfont=\normalfont\itshape,
    headpunct={},
    postheadspace=\newline,
    postheadhook={\textcolor{black}{\rule[.6ex]{\linewidth}{0.4pt}}\\},
    spacebelow=\parsep,
    spaceabove=\parsep,
    mdframed={
        backgroundcolor=black!5, 
            linecolor=black!80, 
            innertopmargin=6pt,
            roundcorner=5pt, 
            innerbottommargin=6pt, 
            skipbelow=\parsep, 
            skipbelow=\parsep } 
]{myopenprobstyle}

\declaretheorem[name=Open Problem,style=myopenprobstyle]{openproblem}
\declaretheorem[name=Exercise,style=exercisestyle]{exercise}
\numberwithin{openproblem}{chapter}
\numberwithin{exercise}{chapter}

\declaretheoremstyle[bodyfont=\it,qed=$\lozenge$]{defstyle} 

\declaretheorem[numberlike=equation,style=defstyle]{definition}
\declaretheorem[unnumbered,name=Definition,style=defstyle]{definition*}

\declaretheorem[numberlike=equation,style=defstyle]{example}
\declaretheorem[unnumbered,name=Example,style=defstyle]{example*}

\declaretheorem[numberlike=equation,style=defstyle]{notation}
\declaretheorem[unnumbered,name=Notation=defstyle]{notation*}

\declaretheorem[numberlike=equation,style=defstyle]{construction}
\declaretheorem[unnumbered,name=Construction,style=defstyle]{construction*}

\declaretheorem[numberlike=equation,style=defstyle]{remark}
\declaretheorem[unnumbered,name=Remark,style=defstyle]{remark*}

\renewcommand{\subsectionautorefname}{Subsection}
\renewcommand{\sectionautorefname}{Section}
\renewcommand{\chapterautorefname}{Chapter}
\newenvironment{myproof}[1]%
{\vspace{1ex}\noindent{\em Proof.}\hspace{0.5em}\def\myproof@name{#1}}%
{\hfill{\tiny \qed\ (\myproof@name)}\vspace{1ex}}
\newenvironment{proof-sketch}{\medskip\noindent{\em Sketch of Proof.}\hspace*{1em}}{\qed\bigskip}
\newenvironment{proof-attempt}{\medskip\noindent{\em Proof attempt.}\hspace*{1em}}{\bigskip}
\newenvironment{proofof}[1]{\medskip\noindent\emph{Proof of #1.}\hspace*{1em}}{\qed\bigskip}


\newcommand{\inparen }[1]{\left(#1\right)}             %\inparen{x+y}  is (x+y)
\newcommand{\inbrace }[1]{\left\{#1\right\}}           %\inbrace{x+y}  is {x+y}
\newcommand{\insquare}[1]{\left[#1\right]}             %\insquar{x+y}  is [x+y]
\newcommand{\inangle }[1]{\left\langle#1\right\rangle} %\inangle{A}    is <A>

\newcommand{\abs}[1]{\left|#1\right|}                  %\abs{x}        is |x|
\newcommand{\norm}[1]{\left\Vert#1\right\Vert}         %\norm{x}       is ||x||

\newcommand{\fspan}{\operatorname{\F\text{-span}}}

\newcommand{\union}{\cup}
\newcommand{\Union}{\bigcup}
\newcommand{\intersection}{\cap}
\newcommand{\Intersection}{\bigcap}

\newcommand{\ceil}[1]{\lceil #1 \rceil}
\newcommand{\floor}[1]{\lfloor #1 \rfloor}


\newcommand{\eqdef}{\stackrel{\text{def}}{=}}
\newcommand{\setdef}[2]{\inbrace{{#1}\ : \ {#2}}}      % E.g: \setdef{x}{f(x) = 0}
\newcommand{\set}[1]{\inbrace{#1}}
\newcommand{\innerproduct}[2]{\left\langle{#1},{#2}\right\rangle} %\innerproduct{x}{y} is <x,y>.
\newcommand{\zo}{\inbrace{0,1}}                        % Well just something that is used often!
\newcommand{\parderiv}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pderiv}[2]{\partial_{#2}\inparen{#1}}
\newcommand{\zof}[2]{\inbrace{0,1}^{#1}\longrightarrow \inbrace{0,1}^{#2}}

\newcommand*{\mywedge}{\mathord{\wedge}}


% Commonly used blackboard letters
\newcommand{\FF}{\mathbb{F}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\E}{\mathop{\mathbb{E}}}


\newcommand{\zigzag}{\textcircled{z}}  % for the zig-zag product
\newcommand{\poly}{\operatorname{poly}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\dc}{\operatorname{DetComp}} % for the determinantal complexity
\newcommand{\hess}{\operatorname{Hess}}
\newcommand{\diag}{\operatorname{diag}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\brank}{\operatorname{b-rank}}
\newcommand{\evalDim}{\operatorname{evalDim}}
\newcommand{\Amp}{\operatorname{Amp}}
\newcommand{\coeff}{\operatorname{coeff}}


% \newcommand{\char}{\textrm{char}}
% \newcommand{\rank}{\textrm{rank}}
% \newcommand{\dim}{\textrm{dim}}



%% accented words
\newcommand{\Sebastien}{S\'ebastien }
\newcommand{\Hrubes}{Hrube\v{s} }
\newcommand{\Hastad}{H{\aa}stad }
\newcommand{\Godel}{G\"{o}del }
\newcommand{\Mobius}{M\"{o}bius }
\newcommand{\Gauss}{Gau{\ss} }
\newcommand{\naive}{na\"{\i}ve }
\newcommand{\Naive}{Na\"{\i}ve }
\newcommand{\grobner}{gr\"{o}bner }
\newcommand{\bezout}{b\'{e}zout}
\newcommand{\Bezout}{B\'{e}zout}



\newcommand{\Det}{\operatorname{\mathsf{Det}}}
\newcommand{\Perm}{\operatorname{\mathsf{Perm}}}
\newcommand{\ESym}{\operatorname{\mathsf{Sym}}}
\newcommand{\WESym}{\operatorname{\mathsf{WSym}}}
\newcommand{\PSym}{\operatorname{\mathsf{Pow}}}
\newcommand{\NW}{\operatorname{\mathrm{NW}}}
\newcommand{\IMM}{\operatorname{\mathrm{IMM}}}
\newcommand{\algRank}{\operatorname{\mathrm{algRank}}}
\newcommand{\relRank}{\operatorname{rel-rank}}
\newcommand{\Range}{\operatorname{Range}}

%% Bold letters
\newcommand{\veca}{\mathbf{a}}
\newcommand{\vecb}{\mathbf{b}}
\newcommand{\vecc}{\mathbf{c}}
\newcommand{\vecd}{\mathbf{d}}
\newcommand{\vece}{\mathbf{e}}
\newcommand{\vecf}{\mathbf{f}}
\newcommand{\vecg}{\mathbf{g}}
\newcommand{\vech}{\mathbf{h}}
\newcommand{\veci}{\mathbf{i}}
\newcommand{\vecj}{\mathbf{j}}
\newcommand{\veck}{\mathbf{k}}
\newcommand{\vecl}{\mathbf{l}}
\newcommand{\vecm}{\mathbf{m}}
\newcommand{\vecn}{\mathbf{n}}
\newcommand{\veco}{\mathbf{o}}
\newcommand{\vecp}{\mathbf{p}}
\newcommand{\vecq}{\mathbf{q}}
\newcommand{\vecr}{\mathbf{r}}
\newcommand{\vecs}{\mathbf{s}}
\newcommand{\vect}{\mathbf{t}}
\newcommand{\vecu}{\mathbf{u}}
\newcommand{\vecv}{\mathbf{v}}
\newcommand{\vecw}{\mathbf{w}}
\newcommand{\vecx}{\mathbf{x}}
\newcommand{\vecy}{\mathbf{y}}
\newcommand{\vecz}{\mathbf{z}}

\newcommand{\spaced}[1]{\quad #1 \quad}


%%% Circuit classes
\newcommand{\SPS}{\Sigma\Pi\Sigma}
\newcommand{\SPSP}{\Sigma\Pi\Sigma\Pi}
\newcommand{\SPSE}{\Sigma\Pi\Sigma\mathord{\wedge}}
\newcommand{\SPSPfanin}[2]{\Sigma\Pi^{[#1]}\Sigma\Pi^{[#2]}}
\newcommand{\SPSPsupp}[1]{\Sigma\Pi\Sigma\Pi^{\{#1\}}}
\newcommand{\SESES}{\Sigma\mathord{\wedge}\Sigma\mathord{\wedge}\Sigma}
\newcommand{\SES}{\Sigma\mathord{\wedge}\Sigma}
\newcommand{\SESE}{\Sigma\mathord{\wedge}\Sigma\mathord{\wedge}}
\def\circast{\raisebox{0.2ex}{$\circledast$}}
\newcommand{\SPA}{\Sigma\Pi\circast}
\newcommand{\SASP}[1]{\Sigma\circast^{\set{\!\!\set{#1}\!\!}}\Sigma\Pi}


%%% Some complexity classes. (Don't want to include complexity.sty jsut for this. Messes up with \R etc.
\newcommand{\VP}{\mathsf{VP}}
\newcommand{\VNP}{\mathsf{VNP}}
\newcommand{\NP}{\mathsf{NP}}
\newcommand{\BPP}{\mathsf{BPP}}
\renewcommand{\P}{\mathsf{P}}


\newcommand{\FM}{\mathrm{FM}}
\newcommand{\Mon}{\mathrm{Mon}}
\newcommand{\CM}[1]{\Gamma^{\mathrm{[#1]}}}
\newcommand{\SPD}[3]{\inangle{\partial^{=#1}\inparen{#3}}_{\leq #2}}
\newcommand{\mySPSP}[2]{\Sigma\Pi^{[#1]}\Sigma\Pi^{[#2]}}

\renewcommand{\epsilon}{\varepsilon}

%%% Garbage to be replaced later
\newcommand{\mathify}[1]{\mathrm{#1}}
%\newcommand{\vect}[1]{\mathbf{#1}}
\newcommand{\pfrac}[2]{\inparen{\frac{#1}{#2}}}

\renewcommand{\epsilon}{\varepsilon}
\newcommand{\ignore}[1]{}